<!doctype html>
<html>
  <head>
    <title>La Coop App</title>
    <link rel="stylesheet" href="external/tachyons.min.css">
    <script src="https://s3.amazonaws.com/stitch-sdks/js/bundles/4.3.0/stitch.js"></script>
    <script>
      const client = stitch.Stitch.initializeDefaultAppClient('coopapp-vddhj');

      const db = client.getServiceClient(stitch.RemoteMongoClient.factory, 'coopapp').db('coopapp');

      client.auth.loginWithCredential(new stitch.AnonymousCredential()).then(user =>
        db.collection('coopapp').updateOne({owner_id: client.auth.user.id}, {$set:{number:42}}, {upsert:true})
      ).then(() =>
        db.collection('coopapp').find({owner_id: client.auth.user.id}, { limit: 100}).asArray()
      ).then(docs => {
          console.log("Found docs", docs)
          console.log("[MongoDB Stitch] Connected to Stitch")
      }).catch(err => {
        console.error(err)
      });
    </script>
  </head>
  <body>
    <div id="app"></div>
    <script src="main.js"></script>
  </body>
</html>
